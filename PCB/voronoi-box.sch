EESchema Schematic File Version 4
EELAYER 30 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 1
Title "Voronoi Box"
Date ""
Rev ""
Comp "MPC"
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Comp
L MF_custom:MF_Logo L1
U 1 1 63B4B140
P 8500 6050
F 0 "L1" H 8500 6050 50  0001 C CNN
F 1 "MF_Logo" H 8578 6150 50  0000 L CNN
F 2 "MF custom:mf_logo_10mm" H 8500 6050 50  0001 C CNN
F 3 "" H 8500 6050 50  0001 C CNN
	1    8500 6050
	1    0    0    -1  
$EndComp
$Comp
L Mechanical:MountingHole H1
U 1 1 63B4B95E
P 7450 5900
F 0 "H1" H 7550 5946 50  0000 L CNN
F 1 "MountingHole" H 7550 5855 50  0000 L CNN
F 2 "MountingHole:MountingHole_3.2mm_M3_Pad" H 7450 5900 50  0001 C CNN
F 3 "~" H 7450 5900 50  0001 C CNN
	1    7450 5900
	1    0    0    -1  
$EndComp
$Comp
L Connector_Generic:Conn_01x02 J2
U 1 1 63B51FB9
P 950 1550
F 0 "J2" H 1058 1731 50  0000 C CNN
F 1 "USB/PWR" H 1058 1640 50  0000 C CNN
F 2 "Connector_JST:JST_XH_B2B-XH-A_1x02_P2.50mm_Vertical" H 950 1550 50  0001 C CNN
F 3 "~" H 950 1550 50  0001 C CNN
	1    950  1550
	-1   0    0    -1  
$EndComp
$Comp
L Device:C C2
U 1 1 63B52C11
P 4050 4300
F 0 "C2" H 4165 4346 50  0000 L CNN
F 1 "100nF" H 4165 4255 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 4088 4150 50  0001 C CNN
F 3 "~" H 4050 4300 50  0001 C CNN
F 4 "C14663" H 4050 4300 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 4050 4300 50  0001 C CNN "JLC Part"
	1    4050 4300
	1    0    0    -1  
$EndComp
Text Notes 600  5950 0    50   ~ 0
IO
Text Notes 600  1600 0    50   ~ 0
Power
Text Notes 550  3850 0    50   ~ 0
Microcontroller
$Comp
L power:VCC #PWR0102
U 1 1 63B57B41
P 10000 1400
F 0 "#PWR0102" H 10000 1250 50  0001 C CNN
F 1 "VCC" H 10015 1573 50  0000 C CNN
F 2 "" H 10000 1400 50  0001 C CNN
F 3 "" H 10000 1400 50  0001 C CNN
	1    10000 1400
	1    0    0    -1  
$EndComp
Wire Wire Line
	10000 2300 9800 2300
$Comp
L power:VBUS #PWR0103
U 1 1 63B5891A
P 8050 1400
F 0 "#PWR0103" H 8050 1250 50  0001 C CNN
F 1 "VBUS" H 8065 1573 50  0000 C CNN
F 2 "" H 8050 1400 50  0001 C CNN
F 3 "" H 8050 1400 50  0001 C CNN
	1    8050 1400
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0105
U 1 1 63B5C680
P 1150 2000
F 0 "#PWR0105" H 1150 1750 50  0001 C CNN
F 1 "GND" H 1155 1827 50  0000 C CNN
F 2 "" H 1150 2000 50  0001 C CNN
F 3 "" H 1150 2000 50  0001 C CNN
	1    1150 2000
	1    0    0    -1  
$EndComp
Wire Notes Line
	7000 3400 11200 3400
Text Notes 7050 5600 0    50   ~ 0
Misc
$Comp
L power:VCC #PWR0113
U 1 1 63BA3D9A
P 1750 4200
F 0 "#PWR0113" H 1750 4050 50  0001 C CNN
F 1 "VCC" H 1765 4373 50  0000 C CNN
F 2 "" H 1750 4200 50  0001 C CNN
F 3 "" H 1750 4200 50  0001 C CNN
	1    1750 4200
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0114
U 1 1 63BA444A
P 1750 5400
F 0 "#PWR0114" H 1750 5150 50  0001 C CNN
F 1 "GND" H 1755 5227 50  0000 C CNN
F 2 "" H 1750 5400 50  0001 C CNN
F 3 "" H 1750 5400 50  0001 C CNN
	1    1750 5400
	1    0    0    -1  
$EndComp
Text Notes 3250 5550 0    50   ~ 0
<= 8 MHz with any precision, so no external oscillator\n-> set via chip fuses\n\nVBAT can be measured from VCC, keep AREF floating\n\nPB1 can PWM, PB2 has INT0, all have internal pull-up. 
Text Notes 7600 4650 0    50   ~ 0
>= 400mAh
$Comp
L Device:R R1
U 1 1 63BAFE3F
P 2500 5150
F 0 "R1" V 2293 5150 50  0000 C CNN
F 1 "4.7k" V 2384 5150 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 2430 5150 50  0001 C CNN
F 3 "~" H 2500 5150 50  0001 C CNN
F 4 "C23162" H 2500 5150 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 2500 5150 50  0001 C CNN "JLC Part"
	1    2500 5150
	-1   0    0    1   
$EndComp
$Comp
L power:VCC #PWR0115
U 1 1 63BB0C99
P 2900 5300
F 0 "#PWR0115" H 2900 5150 50  0001 C CNN
F 1 "VCC" H 2915 5473 50  0000 C CNN
F 2 "" H 2900 5300 50  0001 C CNN
F 3 "" H 2900 5300 50  0001 C CNN
	1    2900 5300
	1    0    0    -1  
$EndComp
$Comp
L MCU_Microchip_ATtiny:ATtiny85-20PU U1
U 1 1 63BBBD30
P 1750 4800
F 0 "U1" H 1221 4846 50  0000 R CNN
F 1 "ATtiny85-20PU" H 1221 4755 50  0000 R CNN
F 2 "Package_DIP:DIP-8_W7.62mm" H 1750 4800 50  0001 C CIN
F 3 "http://ww1.microchip.com/downloads/en/DeviceDoc/atmel-2586-avr-8-bit-microcontroller-attiny25-attiny45-attiny85_datasheet.pdf" H 1750 4800 50  0001 C CNN
F 4 "*" H 1750 4800 50  0001 C CNN "LCSC Part"
	1    1750 4800
	1    0    0    -1  
$EndComp
$Comp
L Connector:TestPoint TP1
U 1 1 63BBE28E
P 2600 4500
F 0 "TP1" V 2554 4688 50  0000 L CNN
F 1 "AREF" V 2645 4688 50  0000 L CNN
F 2 "TestPoint:TestPoint_Pad_D1.5mm" H 2800 4500 50  0001 C CNN
F 3 "~" H 2800 4500 50  0001 C CNN
	1    2600 4500
	0    1    1    0   
$EndComp
$Comp
L power:GND #PWR0117
U 1 1 63BC0AB6
P 1750 2000
F 0 "#PWR0117" H 1750 1750 50  0001 C CNN
F 1 "GND" H 1755 1827 50  0000 C CNN
F 2 "" H 1750 2000 50  0001 C CNN
F 3 "" H 1750 2000 50  0001 C CNN
	1    1750 2000
	1    0    0    -1  
$EndComp
$Comp
L Mechanical:MountingHole H2
U 1 1 63BC69A3
P 7450 6200
F 0 "H2" H 7550 6246 50  0000 L CNN
F 1 "MountingHole" H 7550 6155 50  0000 L CNN
F 2 "MountingHole:MountingHole_3.2mm_M3_Pad" H 7450 6200 50  0001 C CNN
F 3 "~" H 7450 6200 50  0001 C CNN
	1    7450 6200
	1    0    0    -1  
$EndComp
Text Label 2350 4800 0    50   ~ 0
D_switches
Wire Wire Line
	2600 4500 2350 4500
Text Notes 700  2500 0    50   ~ 0
Reverse polarity should be short-circuited through diode, \nwhich triggers short circuit protection F1. 
Text Notes 8600 6250 0    50   ~ 0
TODO: MPC Logo
Wire Wire Line
	2500 5000 2350 5000
Wire Wire Line
	2500 5300 2900 5300
$Comp
L power:VCC #PWR0118
U 1 1 63B9790F
P 4050 4150
F 0 "#PWR0118" H 4050 4000 50  0001 C CNN
F 1 "VCC" H 4065 4323 50  0000 C CNN
F 2 "" H 4050 4150 50  0001 C CNN
F 3 "" H 4050 4150 50  0001 C CNN
	1    4050 4150
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0119
U 1 1 63B97D14
P 4050 4450
F 0 "#PWR0119" H 4050 4200 50  0001 C CNN
F 1 "GND" H 4055 4277 50  0000 C CNN
F 2 "" H 4050 4450 50  0001 C CNN
F 3 "" H 4050 4450 50  0001 C CNN
	1    4050 4450
	1    0    0    -1  
$EndComp
$Comp
L Switch:SW_DIP_x01 SW0
U 1 1 63B4E7AA
P 9500 2300
F 0 "SW0" H 9500 2567 50  0000 C CNN
F 1 "SW_ON/OFF" H 9500 2476 50  0000 C CNN
F 2 "" H 9500 2300 50  0001 C CNN
F 3 "~" H 9500 2300 50  0001 C CNN
	1    9500 2300
	1    0    0    -1  
$EndComp
$Comp
L Device:Polyfuse F1
U 1 1 63B596DF
P 1500 1200
F 0 "F1" V 1275 1200 50  0000 C CNN
F 1 "1.5A" V 1366 1200 50  0000 C CNN
F 2 "Fuse:Fuse_1206_3216Metric_Pad1.42x1.75mm_HandSolder" H 1550 1000 50  0001 L CNN
F 3 "~" H 1500 1200 50  0001 C CNN
F 4 "C883133" H 1500 1200 50  0001 C CNN "LCSC Part"
	1    1500 1200
	0    1    1    0   
$EndComp
Wire Wire Line
	1650 1200 1750 1200
$Comp
L LCSC:XB8089D0 U3
U 1 1 63BE38C8
P 10200 4450
F 0 "U3" H 10200 3963 60  0000 C CNN
F 1 "XB8089D0" H 10200 4069 60  0000 C CNN
F 2 "lcsc:SOIC-8_L4.9-W3.9-P1.27-LS6.0-BL-EP3.3-1" H 10200 3950 60  0001 C CNN
F 3 "" H 10200 4450 50  0001 C CNN
F 4 "xysemi(赛芯微)" H 10200 4450 0   0001 C CNN "Manufacturer"
F 5 "C2760005" H 10200 4450 0   0001 C CNN "LCSC Part"
F 6 "Extended Part" H 10200 4450 0   0001 C CNN "JLC Part"
	1    10200 4450
	-1   0    0    1   
$EndComp
Wire Wire Line
	9800 4650 9650 4650
Wire Wire Line
	9650 4650 9650 4550
Wire Wire Line
	9800 4450 9650 4450
Connection ~ 9650 4450
Wire Wire Line
	9800 4550 9650 4550
Connection ~ 9650 4550
Wire Wire Line
	9650 4550 9650 4450
Wire Wire Line
	9800 4250 9650 4250
Wire Wire Line
	9650 4250 9650 4450
Text Notes 7050 3600 0    50   ~ 0
Battery Protection (Optional)\n4.25 V -> 4.10 V | 2.90 V-> 3.0 V | 10.0 A
Text Notes 7150 3850 0    50   ~ 0
// How can it be good to have a resistor in series??
Text Notes 8850 5300 0    50   ~ 0
bridge to bypass BMS
$Comp
L LCSC:AO3415_C181094 Q1
U 1 1 63C09959
P 8750 1800
F 0 "Q1" H 9058 1853 60  0000 L CNN
F 1 "AO3415_C181094" H 9058 1747 60  0000 L CNN
F 2 "lcsc:SOT-23-3_L2.9-W1.3-P1.90-LS2.4-BR" H 8750 1300 60  0001 C CNN
F 3 "https://lcsc.com/product-detail/MOSFET_AO3415_C181094.html" H 8750 1200 60  0001 C CNN
F 4 "Hottech(合科泰)" H 8750 1800 0   0001 C CNN "Manufacturer"
F 5 "C181094" H 8750 1800 0   0001 C CNN "LCSC Part"
F 6 "Extended Part" H 8750 1800 0   0001 C CNN "JLC Part"
	1    8750 1800
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR013
U 1 1 63C45FD2
P 10600 5050
F 0 "#PWR013" H 10600 4800 50  0001 C CNN
F 1 "GND" H 10605 4877 50  0000 C CNN
F 2 "" H 10600 5050 50  0001 C CNN
F 3 "" H 10600 5050 50  0001 C CNN
	1    10600 5050
	1    0    0    -1  
$EndComp
Wire Wire Line
	8550 1800 8050 1800
$Comp
L Device:R R9
U 1 1 63C8C8F4
P 8050 2550
F 0 "R9" V 7843 2550 50  0000 C CNN
F 1 "47k" V 7934 2550 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 7980 2550 50  0001 C CNN
F 3 "~" H 8050 2550 50  0001 C CNN
F 4 "C25819" H 8050 2550 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 8050 2550 50  0001 C CNN "JLC Part"
	1    8050 2550
	-1   0    0    1   
$EndComp
$Comp
L power:GND #PWR011
U 1 1 63C8EAE0
P 8050 2800
F 0 "#PWR011" H 8050 2550 50  0001 C CNN
F 1 "GND" H 8055 2627 50  0000 C CNN
F 2 "" H 8050 2800 50  0001 C CNN
F 3 "" H 8050 2800 50  0001 C CNN
	1    8050 2800
	1    0    0    -1  
$EndComp
Wire Wire Line
	8050 2800 8050 2700
Connection ~ 8050 1800
Wire Wire Line
	8950 1400 8950 1600
Wire Wire Line
	8050 1400 8050 1800
$Comp
L power:+BATT #PWR014
U 1 1 63D4DB63
P 8950 1400
F 0 "#PWR014" H 8950 1250 50  0001 C CNN
F 1 "+BATT" H 8965 1573 50  0000 C CNN
F 2 "" H 8950 1400 50  0001 C CNN
F 3 "" H 8950 1400 50  0001 C CNN
	1    8950 1400
	1    0    0    -1  
$EndComp
Connection ~ 8950 2300
Wire Wire Line
	8950 2000 8950 2300
Wire Wire Line
	8950 2300 8650 2300
Connection ~ 8050 2300
Wire Wire Line
	8050 2400 8050 2300
Wire Wire Line
	8050 1800 8050 2300
$Comp
L LCSC:SS34_C8678 D3
U 1 1 63C19D4C
P 8450 2300
F 0 "D3" H 8450 2033 60  0000 C CNN
F 1 "SS34_C8678" H 8450 2139 60  0000 C CNN
F 2 "lcsc:SMA_L4.3-W2.6-LS5.2-RD" H 8450 2000 60  0001 C CNN
F 3 "https://lcsc.com/product-detail/Schottky-Barrier-Diodes-SBD_SS34_C8678.html" H 8450 1900 60  0001 C CNN
F 4 "MDD" H 8450 2300 0   0001 C CNN "Manufacturer"
F 5 "C8678" H 8450 2300 0   0001 C CNN "LCSC Part"
F 6 "Basic Part" H 8450 2300 0   0001 C CNN "JLC Part"
	1    8450 2300
	-1   0    0    1   
$EndComp
Wire Wire Line
	8050 2300 8250 2300
$Comp
L power:VBUS #PWR01
U 1 1 63D54B87
P 1750 1200
F 0 "#PWR01" H 1750 1050 50  0001 C CNN
F 1 "VBUS" H 1765 1373 50  0000 C CNN
F 2 "" H 1750 1200 50  0001 C CNN
F 3 "" H 1750 1200 50  0001 C CNN
	1    1750 1200
	1    0    0    -1  
$EndComp
Wire Wire Line
	1150 1200 1150 1550
Wire Wire Line
	1150 1650 1150 2000
Wire Wire Line
	8950 2300 9200 2300
Text Notes 2800 6950 0    50   ~ 0
...
Wire Wire Line
	1150 1200 1350 1200
Text Notes 7450 700  0    50   ~ 0
Load Sharing/Power Path
$Comp
L Connector_Generic:Conn_01x02 J1
U 1 1 63B7CAB7
P 8200 4550
F 0 "J1" H 8308 4731 50  0000 C CNN
F 1 "LiPo (1S/3.7V)" H 8308 4640 50  0000 C CNN
F 2 "Connector_JST:JST_XH_B2B-XH-A_1x02_P2.50mm_Vertical" H 8200 4550 50  0001 C CNN
F 3 "~" H 8200 4550 50  0001 C CNN
	1    8200 4550
	-1   0    0    -1  
$EndComp
Wire Wire Line
	8400 4350 8400 4550
$Comp
L power:+BATT #PWR012
U 1 1 63D455C0
P 8400 4350
F 0 "#PWR012" H 8400 4200 50  0001 C CNN
F 1 "+BATT" H 8415 4523 50  0000 C CNN
F 2 "" H 8400 4350 50  0001 C CNN
F 3 "" H 8400 4350 50  0001 C CNN
	1    8400 4350
	1    0    0    -1  
$EndComp
Connection ~ 8400 4350
Connection ~ 9150 4650
$Comp
L Device:R R10
U 1 1 63BF404F
P 8800 4350
F 0 "R10" V 8593 4350 50  0000 C CNN
F 1 "1k" V 8684 4350 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 8730 4350 50  0001 C CNN
F 3 "~" H 8800 4350 50  0001 C CNN
F 4 "C21190" H 8800 4350 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 8800 4350 50  0001 C CNN "JLC Part"
	1    8800 4350
	0    1    1    0   
$EndComp
$Comp
L Device:C C4
U 1 1 63C0DB84
P 9150 4500
F 0 "C4" H 9265 4546 50  0000 L CNN
F 1 "100nF" H 9265 4455 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 9188 4350 50  0001 C CNN
F 3 "~" H 9150 4500 50  0001 C CNN
F 4 "C14663" H 9150 4500 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 9150 4500 50  0001 C CNN "JLC Part"
	1    9150 4500
	1    0    0    -1  
$EndComp
Wire Wire Line
	9150 4350 9800 4350
Wire Wire Line
	9150 4650 9650 4650
Connection ~ 9650 4650
Wire Wire Line
	8950 4350 9150 4350
Connection ~ 9150 4350
Text Notes 3050 800  0    50   ~ 0
LiPo Charger
Connection ~ 3300 1200
$Comp
L power:VBUS #PWR02
U 1 1 63D8CDB6
P 3300 1200
F 0 "#PWR02" H 3300 1050 50  0001 C CNN
F 1 "VBUS" H 3315 1373 50  0000 C CNN
F 2 "" H 3300 1200 50  0001 C CNN
F 3 "" H 3300 1200 50  0001 C CNN
	1    3300 1200
	1    0    0    -1  
$EndComp
Connection ~ 6350 1300
Wire Wire Line
	6350 1500 6350 1300
Wire Wire Line
	6350 1800 6350 2000
$Comp
L power:+BATT #PWR09
U 1 1 63D4A720
P 6350 1300
F 0 "#PWR09" H 6350 1150 50  0001 C CNN
F 1 "+BATT" H 6365 1473 50  0000 C CNN
F 2 "" H 6350 1300 50  0001 C CNN
F 3 "" H 6350 1300 50  0001 C CNN
	1    6350 1300
	1    0    0    -1  
$EndComp
Wire Wire Line
	3300 1800 3300 2000
Wire Wire Line
	3650 1300 3650 2000
Wire Wire Line
	3950 2000 3950 1800
Wire Notes Line
	6750 650  3000 650 
Wire Notes Line
	6750 2550 6750 650 
Wire Notes Line
	3000 2550 6750 2550
Wire Notes Line
	3000 650  3000 2550
Wire Wire Line
	5100 1300 6350 1300
$Comp
L power:GND #PWR010
U 1 1 63C5ED66
P 6350 2000
F 0 "#PWR010" H 6350 1750 50  0001 C CNN
F 1 "GND" H 6355 1827 50  0000 C CNN
F 2 "" H 6350 2000 50  0001 C CNN
F 3 "" H 6350 2000 50  0001 C CNN
	1    6350 2000
	1    0    0    -1  
$EndComp
$Comp
L Device:C C3
U 1 1 63C5ED60
P 6350 1650
F 0 "C3" H 6465 1696 50  0000 L CNN
F 1 "1uF" H 6465 1605 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 6388 1500 50  0001 C CNN
F 3 "~" H 6350 1650 50  0001 C CNN
F 4 "C15849" H 6350 1650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 6350 1650 50  0001 C CNN "JLC Part"
	1    6350 1650
	1    0    0    -1  
$EndComp
Wire Wire Line
	5100 1200 5650 1200
Connection ~ 5650 1200
Wire Wire Line
	5650 1200 5650 1400
$Comp
L Jumper:SolderJumper_2_Bridged JP1
U 1 1 63C53736
P 5650 1550
F 0 "JP1" V 5604 1618 50  0000 L CNN
F 1 "Cut for NTC" V 5695 1618 50  0000 L CNN
F 2 "Jumper:SolderJumper-2_P1.3mm_Bridged_RoundedPad1.0x1.5mm" H 5650 1550 50  0001 C CNN
F 3 "~" H 5650 1550 50  0001 C CNN
	1    5650 1550
	0    1    1    0   
$EndComp
$Comp
L power:GND #PWR07
U 1 1 63C526CF
P 5650 2000
F 0 "#PWR07" H 5650 1750 50  0001 C CNN
F 1 "GND" H 5655 1827 50  0000 C CNN
F 2 "" H 5650 2000 50  0001 C CNN
F 3 "" H 5650 2000 50  0001 C CNN
	1    5650 2000
	1    0    0    -1  
$EndComp
$Comp
L Device:R R4
U 1 1 63C52161
P 5650 1850
F 0 "R4" V 5443 1850 50  0000 C CNN
F 1 "10k" V 5534 1850 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 5580 1850 50  0001 C CNN
F 3 "~" H 5650 1850 50  0001 C CNN
F 4 "C25804" H 5650 1850 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 5650 1850 50  0001 C CNN "JLC Part"
	1    5650 1850
	-1   0    0    1   
$EndComp
Text Notes 5450 1100 0    50   ~ 0
10k @ 25°C NTC
$Comp
L Connector:TestPoint TP3
U 1 1 63C4DB1F
P 5650 1200
F 0 "TP3" V 5604 1388 50  0000 L CNN
F 1 "TEMP" V 5695 1388 50  0000 L CNN
F 2 "TestPoint:TestPoint_THTPad_D2.0mm_Drill1.0mm" H 5850 1200 50  0001 C CNN
F 3 "~" H 5850 1200 50  0001 C CNN
	1    5650 1200
	0    1    1    0   
$EndComp
Text Notes 4150 2150 0    50   ~ 0
R_ISET = 540 / I_OUT\n10.8k (50mA) .. 675(800mA)\n2.2k -> 250mA
$Comp
L Device:LED D2
U 1 1 63C31312
P 1250 7100
F 0 "D2" V 1289 6982 50  0000 R CNN
F 1 "LED" V 1198 6982 50  0000 R CNN
F 2 "LED_SMD:LED_1206_3216Metric_Pad1.42x1.75mm_HandSolder" H 1250 7100 50  0001 C CNN
F 3 "~" H 1250 7100 50  0001 C CNN
	1    1250 7100
	0    -1   -1   0   
$EndComp
Wire Wire Line
	3950 1400 4100 1400
Wire Wire Line
	3950 1500 3950 1400
Wire Wire Line
	3650 1300 4100 1300
$Comp
L LCSC:BQ21040DBVR U2
U 1 1 63C088F8
P 4600 1300
F 0 "U2" H 4600 1687 60  0000 C CNN
F 1 "BQ21040DBVR" H 4600 1581 60  0000 C CNN
F 2 "lcsc:SOT-23-6_L2.9-W1.6-P0.95-LS2.8-BR" H 4600 900 60  0001 C CNN
F 3 "https://lcsc.com/product-detail/PMIC-Battery-Management_TI_BQ21040DBVR_BQ21040DBVR_C202311.html" H 4600 800 60  0001 C CNN
F 4 "TI(德州仪器)" H 4600 1300 0   0001 C CNN "Manufacturer"
F 5 "C202311" H 4600 1300 0   0001 C CNN "LCSC Part"
F 6 "Extended Part" H 4600 1300 0   0001 C CNN "JLC Part"
	1    4600 1300
	-1   0    0    -1  
$EndComp
Wire Wire Line
	3300 1200 4100 1200
$Comp
L power:GND #PWR03
U 1 1 63C216F1
P 3300 2000
F 0 "#PWR03" H 3300 1750 50  0001 C CNN
F 1 "GND" H 3305 1827 50  0000 C CNN
F 2 "" H 3300 2000 50  0001 C CNN
F 3 "" H 3300 2000 50  0001 C CNN
	1    3300 2000
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR05
U 1 1 63C2015C
P 3950 2000
F 0 "#PWR05" H 3950 1750 50  0001 C CNN
F 1 "GND" H 3955 1827 50  0000 C CNN
F 2 "" H 3950 2000 50  0001 C CNN
F 3 "" H 3950 2000 50  0001 C CNN
	1    3950 2000
	1    0    0    -1  
$EndComp
$Comp
L Device:R R2
U 1 1 63C1F619
P 3950 1650
F 0 "R2" V 3743 1650 50  0000 C CNN
F 1 "2.2k" V 3834 1650 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 3880 1650 50  0001 C CNN
F 3 "~" H 3950 1650 50  0001 C CNN
F 4 "C4190" H 3950 1650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 3950 1650 50  0001 C CNN "JLC Part"
	1    3950 1650
	-1   0    0    1   
$EndComp
$Comp
L power:GND #PWR04
U 1 1 63C1DEA0
P 3650 2000
F 0 "#PWR04" H 3650 1750 50  0001 C CNN
F 1 "GND" H 3655 1827 50  0000 C CNN
F 2 "" H 3650 2000 50  0001 C CNN
F 3 "" H 3650 2000 50  0001 C CNN
	1    3650 2000
	1    0    0    -1  
$EndComp
$Comp
L Device:C C1
U 1 1 63BDE6F5
P 3300 1650
F 0 "C1" H 3415 1696 50  0000 L CNN
F 1 "1uF" H 3415 1605 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 3338 1500 50  0001 C CNN
F 3 "~" H 3300 1650 50  0001 C CNN
F 4 "C15849" H 3300 1650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 3300 1650 50  0001 C CNN "JLC Part"
	1    3300 1650
	1    0    0    -1  
$EndComp
Wire Wire Line
	3300 1500 3300 1200
Wire Wire Line
	9150 4700 9150 4650
$Comp
L LCSC:SS34_C8678 D1
U 1 1 63DEBCCB
P 1750 1600
F 0 "D1" V 1697 1708 60  0000 L CNN
F 1 "SS34_C8678" V 1803 1708 60  0000 L CNN
F 2 "lcsc:SMA_L4.3-W2.6-LS5.2-RD" H 1750 1300 60  0001 C CNN
F 3 "https://lcsc.com/product-detail/Schottky-Barrier-Diodes-SBD_SS34_C8678.html" H 1750 1200 60  0001 C CNN
F 4 "MDD" H 1750 1600 0   0001 C CNN "Manufacturer"
F 5 "C8678" H 1750 1600 0   0001 C CNN "LCSC Part"
F 6 "Basic Part" H 1750 1600 0   0001 C CNN "JLC Part"
	1    1750 1600
	0    1    1    0   
$EndComp
Wire Wire Line
	1750 1400 1750 1200
Connection ~ 1750 1200
Wire Wire Line
	1750 1800 1750 2000
Text Notes 4600 1700 0    50   ~ 0
Low while charging\nUse LED or PB4
Wire Notes Line
	7000 500  7000 6500
Wire Notes Line
	500  5800 7000 5800
Wire Notes Line
	7000 5500 11200 5500
Wire Notes Line
	500  3700 7000 3700
Wire Wire Line
	10000 1400 10000 2300
Text Label 5100 1400 0    50   ~ 0
CHRG
$Comp
L power:VCC #PWR0104
U 1 1 63E9C419
P 1250 6650
F 0 "#PWR0104" H 1250 6500 50  0001 C CNN
F 1 "VCC" H 1265 6823 50  0000 C CNN
F 2 "" H 1250 6650 50  0001 C CNN
F 3 "" H 1250 6650 50  0001 C CNN
	1    1250 6650
	1    0    0    -1  
$EndComp
Text Label 1250 7450 0    50   ~ 0
CHRG
Wire Wire Line
	1250 7250 1250 7450
Text Label 2350 4600 0    50   ~ 0
D_LEDS
Text Label 2350 4700 0    50   ~ 0
D_LEDS2
Text Label 3200 4750 0    50   ~ 0
CHRG
Text Notes 800  6300 0    50   ~ 0
Charging Indicator LED (Optional)
Text Label 4000 6500 0    50   ~ 0
D_switches
$Comp
L Switch:SW_Push SW1
U 1 1 63EDF8D1
P 3000 7000
F 0 "SW1" H 3000 7285 50  0000 C CNN
F 1 "SW_1" H 3000 7194 50  0000 C CNN
F 2 "Button_Switch_THT:SW_PUSH_6mm_H4.3mm" H 3000 7200 50  0001 C CNN
F 3 "~" H 3000 7200 50  0001 C CNN
	1    3000 7000
	0    -1   -1   0   
$EndComp
$Comp
L power:GND #PWR0106
U 1 1 63EE0EAF
P 4000 7200
F 0 "#PWR0106" H 4000 6950 50  0001 C CNN
F 1 "GND" H 4005 7027 50  0000 C CNN
F 2 "" H 4000 7200 50  0001 C CNN
F 3 "" H 4000 7200 50  0001 C CNN
	1    4000 7200
	1    0    0    -1  
$EndComp
$Comp
L Device:R R11
U 1 1 63EE1AA1
P 3000 6650
F 0 "R11" V 2793 6650 50  0000 C CNN
F 1 "1k" V 2884 6650 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 2930 6650 50  0001 C CNN
F 3 "~" H 3000 6650 50  0001 C CNN
F 4 "C21190" H 3000 6650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 3000 6650 50  0001 C CNN "JLC Part"
	1    3000 6650
	1    0    0    -1  
$EndComp
$Comp
L Switch:SW_Push SW3
U 1 1 63EE673E
P 3800 7000
F 0 "SW3" H 3800 7285 50  0000 C CNN
F 1 "SW_3" H 3800 7194 50  0000 C CNN
F 2 "Button_Switch_THT:SW_PUSH_6mm_H4.3mm" H 3800 7200 50  0001 C CNN
F 3 "~" H 3800 7200 50  0001 C CNN
	1    3800 7000
	0    -1   -1   0   
$EndComp
$Comp
L Device:R R13
U 1 1 63EE6744
P 3800 6650
F 0 "R13" V 3593 6650 50  0000 C CNN
F 1 "4.7k" V 3684 6650 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 3730 6650 50  0001 C CNN
F 3 "~" H 3800 6650 50  0001 C CNN
F 4 "C23162" H 3800 6650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 3800 6650 50  0001 C CNN "JLC Part"
	1    3800 6650
	1    0    0    -1  
$EndComp
$Comp
L Switch:SW_Push SW2
U 1 1 63EE87F2
P 3400 7000
F 0 "SW2" H 3400 7285 50  0000 C CNN
F 1 "SW_2" H 3400 7194 50  0000 C CNN
F 2 "Button_Switch_THT:SW_PUSH_6mm_H4.3mm" H 3400 7200 50  0001 C CNN
F 3 "~" H 3400 7200 50  0001 C CNN
	1    3400 7000
	0    -1   -1   0   
$EndComp
$Comp
L Device:R R12
U 1 1 63EE87F8
P 3400 6650
F 0 "R12" V 3193 6650 50  0000 C CNN
F 1 "2.2k" V 3284 6650 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 3330 6650 50  0001 C CNN
F 3 "~" H 3400 6650 50  0001 C CNN
F 4 "C4190" H 3400 6650 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 3400 6650 50  0001 C CNN "JLC Part"
	1    3400 6650
	1    0    0    -1  
$EndComp
Wire Wire Line
	4000 6500 3800 6500
Connection ~ 3400 6500
Wire Wire Line
	3400 6500 3000 6500
Connection ~ 3800 6500
Wire Wire Line
	3800 6500 3400 6500
Wire Wire Line
	4000 7200 3800 7200
Connection ~ 3400 7200
Wire Wire Line
	3400 7200 3000 7200
Connection ~ 3800 7200
Wire Wire Line
	3800 7200 3400 7200
Text Notes 3750 6300 0    50   ~ 0
Internal Pullup 20..50k
$Comp
L Device:C C6
U 1 1 63EF297F
P 4000 6850
F 0 "C6" H 4115 6896 50  0000 L CNN
F 1 "100nF" H 4115 6805 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 4038 6700 50  0001 C CNN
F 3 "~" H 4000 6850 50  0001 C CNN
F 4 "C14663" H 4000 6850 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 4000 6850 50  0001 C CNN "JLC Part"
	1    4000 6850
	1    0    0    -1  
$EndComp
Wire Wire Line
	4000 6700 4000 6500
Wire Wire Line
	4000 7000 4000 7200
Connection ~ 4000 7200
Text Label 5750 7000 2    50   ~ 0
D_LEDS2
$Comp
L Connector_Generic:Conn_01x04 J3
U 1 1 63F1784C
P 5950 6900
F 0 "J3" H 5978 6926 50  0000 L CNN
F 1 "LEDs" H 5978 6835 50  0000 L CNN
F 2 "Connector_JST:JST_XH_B4B-XH-A_1x04_P2.50mm_Vertical" H 5950 6900 50  0001 C CNN
F 3 "~" H 5950 6900 50  0001 C CNN
	1    5950 6900
	1    0    0    -1  
$EndComp
$Comp
L power:VCC #PWR0107
U 1 1 63F17852
P 5750 6800
F 0 "#PWR0107" H 5750 6650 50  0001 C CNN
F 1 "VCC" H 5765 6973 50  0000 C CNN
F 2 "" H 5750 6800 50  0001 C CNN
F 3 "" H 5750 6800 50  0001 C CNN
	1    5750 6800
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0108
U 1 1 63F17858
P 5750 7100
F 0 "#PWR0108" H 5750 6850 50  0001 C CNN
F 1 "GND" H 5755 6927 50  0000 C CNN
F 2 "" H 5750 7100 50  0001 C CNN
F 3 "" H 5750 7100 50  0001 C CNN
	1    5750 7100
	1    0    0    -1  
$EndComp
Text Label 5750 6900 2    50   ~ 0
D_LEDS
Text Notes 5400 6450 0    50   ~ 0
Ignore [3] for SK6812, WS2812B
$Comp
L Connector:AVR-ISP-6 J4
U 1 1 63F240FE
P 6000 4750
F 0 "J4" H 5671 4846 50  0000 R CNN
F 1 "AVR-ISP" H 5671 4755 50  0000 R CNN
F 2 "Connector_PinHeader_2.54mm:PinHeader_2x03_P2.54mm_Vertical" V 5750 4800 50  0001 C CNN
F 3 " ~" H 4725 4200 50  0001 C CNN
	1    6000 4750
	1    0    0    -1  
$EndComp
Text Label 2350 5000 0    50   ~ 0
RESET
Text Label 2350 4500 0    50   ~ 0
AREF
$Comp
L power:GND #PWR0109
U 1 1 63F26206
P 5900 5150
F 0 "#PWR0109" H 5900 4900 50  0001 C CNN
F 1 "GND" H 5905 4977 50  0000 C CNN
F 2 "" H 5900 5150 50  0001 C CNN
F 3 "" H 5900 5150 50  0001 C CNN
	1    5900 5150
	1    0    0    -1  
$EndComp
$Comp
L power:VCC #PWR0110
U 1 1 63F267A8
P 5900 4250
F 0 "#PWR0110" H 5900 4100 50  0001 C CNN
F 1 "VCC" H 5915 4423 50  0000 C CNN
F 2 "" H 5900 4250 50  0001 C CNN
F 3 "" H 5900 4250 50  0001 C CNN
	1    5900 4250
	1    0    0    -1  
$EndComp
Text Notes 5000 3950 0    50   ~ 0
Turn off and disconnect LEDs while programming
Text Label 6400 4850 0    50   ~ 0
RESET
Text Label 6400 4650 0    50   ~ 0
AREF
Text Label 6400 4750 0    50   ~ 0
D_LEDS2
Text Label 6400 4550 0    50   ~ 0
D_LEDS
Wire Wire Line
	8400 4650 8500 4650
$Comp
L power:PWR_FLAG #FLG0104
U 1 1 63F33D2D
P 8500 4650
F 0 "#FLG0104" H 8500 4725 50  0001 C CNN
F 1 "PWR_FLAG" V 8500 4778 50  0001 L CNN
F 2 "" H 8500 4650 50  0001 C CNN
F 3 "~" H 8500 4650 50  0001 C CNN
	1    8500 4650
	-1   0    0    1   
$EndComp
Connection ~ 8500 4650
Wire Wire Line
	8500 4650 9150 4650
Wire Wire Line
	8400 4350 8650 4350
$Comp
L power:PWR_FLAG #FLG0101
U 1 1 63F38F80
P 1750 1200
F 0 "#FLG0101" H 1750 1275 50  0001 C CNN
F 1 "PWR_FLAG" V 1750 1328 50  0001 L CNN
F 2 "" H 1750 1200 50  0001 C CNN
F 3 "~" H 1750 1200 50  0001 C CNN
	1    1750 1200
	0    1    1    0   
$EndComp
$Comp
L power:PWR_FLAG #FLG0102
U 1 1 63F39468
P 1750 2000
F 0 "#FLG0102" H 1750 2075 50  0001 C CNN
F 1 "PWR_FLAG" V 1750 2128 50  0001 L CNN
F 2 "" H 1750 2000 50  0001 C CNN
F 3 "~" H 1750 2000 50  0001 C CNN
	1    1750 2000
	0    1    1    0   
$EndComp
Connection ~ 1750 2000
$Comp
L power:PWR_FLAG #FLG0103
U 1 1 63F39B59
P 10000 1400
F 0 "#FLG0103" H 10000 1475 50  0001 C CNN
F 1 "PWR_FLAG" V 10000 1528 50  0001 L CNN
F 2 "" H 10000 1400 50  0001 C CNN
F 3 "~" H 10000 1400 50  0001 C CNN
	1    10000 1400
	0    1    1    0   
$EndComp
Connection ~ 10000 1400
$Comp
L Device:R R3
U 1 1 63C36A56
P 1250 6800
F 0 "R3" V 1043 6800 50  0000 C CNN
F 1 "1.5k" V 1134 6800 50  0000 C CNN
F 2 "Resistor_SMD:R_0603_1608Metric_Pad1.05x0.95mm_HandSolder" V 1180 6800 50  0001 C CNN
F 3 "~" H 1250 6800 50  0001 C CNN
F 4 "C22843" H 1250 6800 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 1250 6800 50  0001 C CNN "JLC Part"
	1    1250 6800
	-1   0    0    1   
$EndComp
Wire Wire Line
	10600 4250 10600 4350
Connection ~ 10600 4350
Wire Wire Line
	10600 4350 10600 4450
Connection ~ 10600 4450
Wire Wire Line
	10600 4450 10600 4550
Connection ~ 10600 4550
Wire Wire Line
	10600 4550 10600 5050
Connection ~ 8400 4650
$Comp
L power:-BATT #PWR0101
U 1 1 63D9628E
P 8400 4650
F 0 "#PWR0101" H 8400 4500 50  0001 C CNN
F 1 "-BATT" H 8415 4823 50  0000 C CNN
F 2 "" H 8400 4650 50  0001 C CNN
F 3 "" H 8400 4650 50  0001 C CNN
	1    8400 4650
	-1   0    0    1   
$EndComp
Connection ~ 10600 5050
Wire Wire Line
	9150 5000 9150 5050
Wire Wire Line
	9150 5050 10600 5050
$Comp
L Jumper:SolderJumper_2_Open JP2
U 1 1 63C18EA6
P 9150 4850
F 0 "JP2" H 9150 5055 50  0000 C CNN
F 1 "Join without BMS" H 9150 4964 50  0000 C CNN
F 2 "Jumper:SolderJumper-2_P1.3mm_Open_RoundedPad1.0x1.5mm" H 9150 4850 50  0001 C CNN
F 3 "~" H 9150 4850 50  0001 C CNN
	1    9150 4850
	0    1    1    0   
$EndComp
Text Notes 7450 5050 0    50   ~ 0
TODO: Check polarity
$Comp
L Jumper:SolderJumper_2_Bridged JP3
U 1 1 63F73305
P 3050 4750
F 0 "JP3" V 3004 4818 50  0000 L CNN
F 1 "Cut for LED" V 3095 4818 50  0000 L CNN
F 2 "Jumper:SolderJumper-2_P1.3mm_Bridged_RoundedPad1.0x1.5mm" H 3050 4750 50  0001 C CNN
F 3 "~" H 3050 4750 50  0001 C CNN
	1    3050 4750
	1    0    0    -1  
$EndComp
$Comp
L Connector:TestPoint TP2
U 1 1 63F84996
P 2900 4900
F 0 "TP2" V 2854 5088 50  0000 L CNN
F 1 "PB4" V 2945 5088 50  0000 L CNN
F 2 "TestPoint:TestPoint_THTPad_D2.0mm_Drill1.0mm" H 3100 4900 50  0001 C CNN
F 3 "~" H 3100 4900 50  0001 C CNN
	1    2900 4900
	0    1    1    0   
$EndComp
Wire Wire Line
	2900 4900 2900 4750
Wire Wire Line
	2350 4900 2900 4900
Connection ~ 2900 4900
Text Notes 700  2750 0    50   ~ 0
TODO: TVS?
$Comp
L Device:C C5
U 1 1 63FA7F7E
P 6300 6950
F 0 "C5" H 6415 6996 50  0000 L CNN
F 1 "22uF" H 6415 6905 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 6338 6800 50  0001 C CNN
F 3 "~" H 6300 6950 50  0001 C CNN
F 4 "C59461" H 6300 6950 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 6300 6950 50  0001 C CNN "JLC Part"
	1    6300 6950
	1    0    0    -1  
$EndComp
$Comp
L power:VCC #PWR06
U 1 1 63FA8BBB
P 6300 6800
F 0 "#PWR06" H 6300 6650 50  0001 C CNN
F 1 "VCC" H 6315 6973 50  0000 C CNN
F 2 "" H 6300 6800 50  0001 C CNN
F 3 "" H 6300 6800 50  0001 C CNN
	1    6300 6800
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR08
U 1 1 63FA953E
P 6300 7100
F 0 "#PWR08" H 6300 6850 50  0001 C CNN
F 1 "GND" H 6305 6927 50  0000 C CNN
F 2 "" H 6300 7100 50  0001 C CNN
F 3 "" H 6300 7100 50  0001 C CNN
	1    6300 7100
	1    0    0    -1  
$EndComp
$Comp
L Device:C C7
U 1 1 63FB3D31
P 2600 1600
F 0 "C7" H 2715 1646 50  0000 L CNN
F 1 "22uF" H 2715 1555 50  0000 L CNN
F 2 "Capacitor_SMD:C_0603_1608Metric" H 2638 1450 50  0001 C CNN
F 3 "~" H 2600 1600 50  0001 C CNN
F 4 "C59461" H 2600 1600 50  0001 C CNN "LCSC Part"
F 5 "Basic Part" H 2600 1600 50  0001 C CNN "JLC Part"
	1    2600 1600
	1    0    0    -1  
$EndComp
$Comp
L power:VBUS #PWR0111
U 1 1 63FB8638
P 2600 1250
F 0 "#PWR0111" H 2600 1100 50  0001 C CNN
F 1 "VBUS" H 2615 1423 50  0000 C CNN
F 2 "" H 2600 1250 50  0001 C CNN
F 3 "" H 2600 1250 50  0001 C CNN
	1    2600 1250
	1    0    0    -1  
$EndComp
$Comp
L power:GND #PWR0112
U 1 1 63FB9838
P 2600 2000
F 0 "#PWR0112" H 2600 1750 50  0001 C CNN
F 1 "GND" H 2605 1827 50  0000 C CNN
F 2 "" H 2600 2000 50  0001 C CNN
F 3 "" H 2600 2000 50  0001 C CNN
	1    2600 2000
	1    0    0    -1  
$EndComp
Wire Wire Line
	2600 2000 2600 1750
Wire Wire Line
	2600 1450 2600 1250
Text Notes 6250 5300 0    50   ~ 0
TODO: Check pins
Text Notes 7650 6950 0    50   ~ 0
TODO: rename
$EndSCHEMATC
